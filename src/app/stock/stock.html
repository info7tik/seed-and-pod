<app-header-menu titleKey="menu.stock.title"></app-header-menu>

<main class="main-content">
    <!-- Add Seed Section -->
    <section class="add-seed-section">
        <div class="section-header">
            <h2>Select the seeds to add to the stock</h2>
            <button class="add-seed-btn" routerLink="/new-seed">
                <svg class="add-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12h14" />
                </svg>
                Add New Seed
            </button>
        </div>

        <div class="add-existing-seed">
            @if (availableSeedsNotInStock.length === 0) {
            <p class="no-seeds-message">All available seeds are already in stock.</p>
            } @else {
            <select class="seed-select" [(ngModel)]="seedIdToAddInStock" (change)="addSeedToStock()">
                @for (seed of availableSeedsNotInStock; track seed.id) {
                <option [value]="seed.id">{{seed.name}} - {{seed.variety}}</option>
                }
            </select>
            }
        </div>
    </section>

    <!-- Stock Management Section -->
    <section class="stock-section">
        <div class="section-header">
            <h2>Current Stock</h2>
            <div class="action-buttons">
                <button class="action-btn remove-btn" (click)="removeSelectedSeeds()"
                    [disabled]="selectedSeedsCount === 0">
                    Remove Selected
                </button>
                <button class="action-btn exhausted-btn" (click)="markSelectedAsExhausted()"
                    [disabled]="selectedSeedsCount === 0">
                    Mark as Exhausted
                </button>
            </div>
        </div>

        <div class="stock-list">
            @if (stockSeeds.length === 0) {
            <p class="empty-message">No seeds in stock. Add some seeds to get started!</p>
            } @else {
            @for (seed of stockSeeds; track seed.id) {
            <div class="seed-item" [class.selected]="isSeedSelected(seed.id)" [class.exhausted]="seed.exhausted">
                <label class="seed-checkbox">
                    <input type="checkbox" [checked]="isSeedSelected(seed.id)" (change)="toggleSeedSelection(seed.id)">
                    <span class="checkmark"></span>
                </label>

                <div class="seed-info">
                    <h3 class="seed-name">{{seed.name}}</h3>
                    <div class="seed-details">
                        <span class="seed-variety">{{seed.variety}}</span>
                        @if (seed.exhausted) {
                        <span class="exhausted-badge">Exhausted</span>
                        }
                    </div>
                </div>

                <div class="seed-actions">
                    @if (seed.exhausted) {
                    <button class="action-btn resupply-btn"
                        (click)="markSelectedAsResupplied(seed.id)">Resupply</button>
                    }
                </div>
            </div>
            }
            }
        </div>
    </section>
</main>