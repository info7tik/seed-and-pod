<app-header-menu titleKey="menu.stock.title"></app-header-menu>

<main class="main-content">
    <!-- Add Seed Section -->
    <div class="section-header">
        <h2>{{'stock.selectSeedsToAdd' | transloco}}</h2>
    </div>

    <div class="add-existing-seed">
        @if (inventorySeedsNotInStock.length === 0) {
        <p class="no-seeds-message">{{'stock.allSeedsInStock' | transloco}}</p>
        } @else {
        <select id="family" name="family" class="seed-select" [(ngModel)]="seedIdToAddInStock"
            (change)="addSeedToStock()">
            <option [value]="DEFAULT_SEED_ID">{{'stock.selectSeed' | transloco}}</option>
            @for (seed of inventorySeedsNotInStock; track seed.id) {
            <option [value]="seed.id">{{seed.name}} - {{seed.family.key| transloco}}</option>
            }
        </select>
        }
    </div>

    <!-- Stock Management Section -->
    <h2>{{'stock.currentStock' | transloco}}</h2>
    <section class="stock-section">
        <div class="stock-list">
            @if (stockSeeds.length === 0) {
            <p class="empty-message">{{'stock.noSeedsInStock' | transloco}}</p>
            } @else {
            <div class="action-buttons">
                <button class="action-btn remove-btn" (click)="removeSelectedSeeds()"
                    [disabled]="selectedSeedsCount === 0">
                    {{'stock.removeSelected' | transloco}}
                </button>
            </div>
            @for (seed of stockSeeds; track seed.id) {
            <div class="seed-item" [class.selected]="isSeedSelected(seed.id)" [class.exhausted]="seed.exhausted">
                <label class="seed-checkbox">
                    <input type="checkbox" [checked]="isSeedSelected(seed.id)" (change)="toggleSeedSelection(seed.id)">
                    <span class="checkmark"></span>
                </label>

                <div class="seed-info">
                    <h3 class="seed-name">{{seed.name}}</h3>
                    <div class="seed-details">
                        <span class="seed-variety">{{seed.family.key| transloco}}</span>
                        @if (seed.exhausted) {
                        <span class="exhausted-badge">{{'stock.exhausted' | transloco}}</span>
                        }
                    </div>
                </div>

                <div class="seed-actions">
                    <button class="action-btn" [class.resupply-btn]="seed.exhausted"
                        [class.exhausted-btn]="!seed.exhausted" (click)="toggleSeedExhaustedState(seed.id)">
                        @if (seed.exhausted) {
                        {{'stock.resupply' | transloco}}
                        } @else {
                        {{'stock.markAsExhausted' | transloco}}
                        }
                    </button>
                </div>
            </div>
            }
            }
        </div>
    </section>
</main>