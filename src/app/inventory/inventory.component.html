<app-header-menu titleKey="menu.inventory.title"></app-header-menu>

<main class="main-content">
    <!-- Add Seed Section -->
    <div class="section-header">
        <h2>{{'inventory.addSeed' | transloco}}</h2>
    </div>
    <section class="add-seed-section">
        @if (errorMessage) {
        <div class="error">{{ errorMessage }}</div>
        }
        @if (successMessage) {
        <div class="success">{{ successMessage }}</div>
        }

        <form (ngSubmit)="addSeed()" #seedForm="ngForm" class="seed-form">
            <div class="form-field">
                <label for="name">{{'inventory.name' | transloco}}</label>
                <input id="name" name="name" type="text" required [(ngModel)]="name" />
            </div>

            <div class="form-field">
                <label for="group">
                    {{'inventory.group' | transloco}}
                    <span class="group-info">
                        ({{'inventory.groupInfo' | transloco}})
                    </span>
                </label>
                <select id="group" name="group" required [(ngModel)]="groupName">
                    @for (group of vegetableGroups; track group.name) {
                    <option [value]="group.name" [style.background-color]="group.color">{{ group.name }}</option>
                    }
                </select>
            </div>

            <div class="form-field">
                <label>{{'inventory.sowingDate' | transloco}}</label>
                <div class="date-inputs">
                    <select id="sowingDay" name="sowingDay" [(ngModel)]="sowingDay">
                        @for (day of daysInMonth; track day) {
                        <option [value]="day">{{ day }}</option>
                        }
                    </select>
                    <select id="sowingMonth" name="sowingMonth" [(ngModel)]="sowingMonth">
                        @for (month of months; track month.id) {
                        <option [value]="month.id">{{ month.key | transloco }}</option>
                        }
                    </select>
                </div>
            </div>

            <div class="form-field">
                <label class="checkbox-label">
                    <input type="checkbox" [(ngModel)]="enableTransplanting" name="enableTransplanting" />
                    {{'inventory.enableTransplanting' | transloco}}
                </label>
            </div>

            @if (enableTransplanting) {
            <div class="form-field">
                <label>{{'inventory.transplantingDate' | transloco}}</label>
                <div class="date-inputs">
                    <select id="transplantingDay" name="transplantingDay" [(ngModel)]="transplantingDay">
                        @for (day of daysInMonth; track day) {
                        <option [value]="day">{{ day }}</option>
                        }
                    </select>
                    <select id="transplantingMonth" name="transplantingMonth" [(ngModel)]="transplantingMonth">
                        @for (month of months; track month.id) {
                        <option [value]="month.id">{{ month.key | transloco }}</option>
                        }
                    </select>
                </div>
            </div>
            }

            <div class="form-field">
                <label for="daysBeforeHarvest">{{'inventory.daysBeforeHarvest' | transloco}}</label>
                <input id="daysBeforeHarvest" name="daysBeforeHarvest" type="number" min="1" required
                    [(ngModel)]="daysBeforeHarvest" />
            </div>

            <button class="action-btn" type="submit" [disabled]="!name">
                {{'inventory.addSeed' | transloco}}
            </button>
        </form>
    </section>

    <!-- Inventory List Section -->
    <section class="inventory-list-section">
        <div class="section-header">
            <h2>{{'inventory.seedInventory' | transloco}}</h2>
        </div>

        <div class="inventory-list">
            @if (inventorySeeds.length === 0) {
            <p class="empty-message">{{'inventory.noSeeds' | transloco}}</p>
            } @else {
            @for (seed of inventorySeeds; track seed.id) {
            <div class="seed-item">
                <div class="seed-info">
                    <h3 class="seed-name">{{ seed.name }}</h3>
                    <div class="seed-details">
                        <span class="seed-group">{{ 'inventory.group' | transloco }} {{ seed.group.name }}</span>
                        <span class="seed-days">{{'inventory.daysBeforeHarvest' | transloco}}: {{ seed.daysBeforeHarvest
                            }}</span>
                    </div>
                    <div class="seed-dates">
                        <span class="sowing-date">
                            {{'inventory.sowing' | transloco}}:
                            {{ this.months[seed.sowing.month-1].key | transloco }} {{ seed.sowing.day }}
                        </span>
                        @if (seed.transplanting.enabled) {
                        <span class="transplanting-date">
                            {{'inventory.transplanting' | transloco}}:
                            {{ this.months[seed.transplanting.month-1].key | transloco }} {{ seed.transplanting.day }}
                        </span>
                        }
                    </div>
                </div>

                <div class="seed-actions">
                    <button class="action-btn remove-btn" (click)="removeSeed(seed.id)">
                        {{'inventory.remove' | transloco}}
                    </button>
                </div>
            </div>
            }
            }
        </div>
    </section>
</main>